<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reproductor de Ràdio en Directe</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Antonio:wght@300;400;500;600&display=swap');
    body { margin: 0; padding: 0; font-family: 'Antonio', sans-serif; background: #1a1a1a; color: #fff; display: flex; justify-content: center; align-items: center; height: 100vh; }
    .player { width: 400px; background: #2a2a2a; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
    .top-section { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .controls { display: flex; align-items: center; gap: 10px; order: 2; }
    .clock { font-family: Antonio; font-size: 14px; color: white; padding-right: 15px; border-right: 1px solid #444; }
    .cover { width: 40px; height: 40px; background: #333; position: relative; overflow: hidden; flex-shrink: 0; order: 3; }
    .disc { width: 100%; height: 100%; background: url('https://via.placeholder.com/200') no-repeat center center/cover; animation: spin 60s linear infinite; animation-play-state: paused; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .info { flex-grow: 1; text-align: left; order: 4; }
    .title { font-size: 0px; margin: 0; }
    .artist { font-size: 14px; margin: 0; line-height: 1.3; }
    .btn { background: none; border: none; color: #fff; font-size: 20px; cursor: pointer; transition: color 0.3s; padding: 5px; }
    .btn:hover { color: #1db954; }
    .progress-container { width: 100%; height: 5px; background: #444; border-radius: 5px; cursor: pointer; }
    .progress { height: 100%; background: #1db954; border-radius: 5px; width: 0%; transition: width 0.1s; }
  </style>
</head>
<body>
  <div class="player"><div class="top-section"><div class="clock" id="clock">--:--:--</div><div class="controls"><button class="btn prev"><i class="fas fa-backward"></i></button><button class="btn play"><i class="fas fa-play"></i></button><button class="btn next"><i class="fas fa-forward"></i></button></div><div class="cover"><div class="disc"></div></div><div class="info"><h3 class="artist" id="title">Carregant...</h3><h3 class="title" id="artist">Ràdio en Directe</h3></div></div><div class="progress-container"><div class="progress"></div></div></div>

  <script>
    // Rellotge
    function updateClock() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
    }
    setInterval(updateClock, 1000);
    updateClock(); // Inicialitza immediatament

    // Reproductor
    const audio = new Audio();
    const playBtn = document.querySelector('.play');
    const prevBtn = document.querySelector('.prev');
    const nextBtn = document.querySelector('.next');
    const disc = document.querySelector('.disc');
    const title = document.getElementById('title');
    const artist = document.getElementById('artist');

    let stations = [];
    let currentStationIndex = 0;
    let isPlaying = false;

    async function loadStations() {
      try {
        const response = await fetch('https://xarxa-1.github.io/Xarxa-1/station1.json');
        stations = await response.json();
        if (stations.length > 0) loadStation(stations[currentStationIndex]);
      } catch (error) {
        title.textContent = "Error carregant estacions";
      }
    }

    function loadStation(station) {
      title.textContent = station.name;
      artist.textContent = "Ràdio en Directe";
      audio.src = station.url;
      disc.style.backgroundImage = `url('${station.logo}')`;
      if (isPlaying) audio.play();
    }

    function togglePlay() {
      isPlaying ? audio.pause() : audio.play();
      playBtn.innerHTML = isPlaying ? '<i class="fas fa-play"></i>' : '<i class="fas fa-pause"></i>';
      disc.style.animationPlayState = isPlaying ? 'paused' : 'running';
      isPlaying = !isPlaying;
    }

    function prevStation() {
      currentStationIndex = (currentStationIndex - 1 + stations.length) % stations.length;
      loadStation(stations[currentStationIndex]);
    }

    function nextStation() {
      currentStationIndex = (currentStationIndex + 1) % stations.length;
      loadStation(stations[currentStationIndex]);
    }

    playBtn.addEventListener('click', togglePlay);
    prevBtn.addEventListener('click', prevStation);
    nextBtn.addEventListener('click', nextStation);
    loadStations();
  </script>
</body>
</html>